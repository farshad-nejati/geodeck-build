import e,{useEffect as j,useState as d}from"https://cdn.skypack.dev/react";import"https://cdn.skypack.dev/lodash";import{Form as l,Input as f,Button as p,Select as g,Upload as E,message as y}from"https://cdn.skypack.dev/antd";import{UploadOutlined as T}from"https://cdn.skypack.dev/@ant-design/icons";import{dummyRequest as U}from"../3d-page/helpers.js";const{Option:k}=g;function G(n){return new Promise((r,s)=>{const a=new FileReader;a.readAsBinaryString(n.originFileObj),a.onload=()=>r(a.result),a.onerror=c=>s(c)})}const B=n=>n?.split(".").pop(),N=n=>{const[r,s]=d(null),[a,c]=d(null),[m,b]=d("gltf"),{form:F,loading:h}=n,i=m==="_blank";let u="Create";h&&(u="Creating..."),j(()=>{a&&(s(null),c(!1))},[r]);const v=t=>B(t?.name)!==m?(y.error("Invalid Type!"),E.LIST_IGNORE):!0,I=async t=>{const o=t?.file;s(o?.originFileObj)},C=t=>{if(!r&&!i)y.error("File not selected!");else{const o={...t,modelFile:r};n.onCompleted(o)}},_=t=>{console.log("Failed:",t)},x={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},R=(t,o)=>o?Promise.resolve():Promise.reject(`${t.field} is required`);return e.createElement(l,{...x,name:"project-upload",form:F,onFinish:C,onFinishFailed:_},e.createElement(l.Item,{label:"Type"},e.createElement(g,{defaultValue:m,onChange:t=>b(t)},e.createElement(k,{value:"gltf"},"GLTF File"),e.createElement(k,{value:"_blank"},"Blank"))),!i&&e.createElement(l.Item,{label:"Data Endpoint URL"},e.createElement(l.Item,{name:"url",noStyle:!0,rules:[{type:"url",message:"please enter a url!"},{validator:R}]},e.createElement(f,{placeholder:"https://example.com",type:"url"}))),!i&&e.createElement(l.Item,{label:"File"},e.createElement(E,{maxCount:1,beforeUpload:v,onChange:I,onRemove:()=>c(!0),accept:`.${m}`,customRequest:U},e.createElement(p,{icon:e.createElement(T,null)},"Upload"))),e.createElement(l.Item,{className:"margin-0 project__form__buttons"},e.createElement(f.Group,{className:"grid__two"},e.createElement(l.Item,{className:"margin-0"},e.createElement(p,{block:!0,type:"default",onClick:n.onCancel},"Back")),e.createElement(l.Item,{className:"margin-0"},e.createElement(p,{block:!0,type:"primary",loading:n?.loading,disabled:n?.loading,htmlType:"submit"},u)))))};export default N;
