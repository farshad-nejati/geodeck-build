import e from"https://cdn.skypack.dev/react";import I from"https://cdn.skypack.dev/lodash";import{Form as t,Input as a,Button as m}from"https://cdn.skypack.dev/antd";import{useMutation as b}from"https://cdn.skypack.dev/@apollo/client";import{UPDATE_PROJECT as j}from"../../apollo/mutations/index.js";import{GET_PROJECTS as k}from"../../apollo/queries/index.js";const v=o=>{const i=localStorage.getItem("sub"),[p]=t.useForm(),l=o?.project,[d,{loading:s}]=b(j,{refetchQueries:[{query:k,variables:{userID:i}}],onCompleted:r=>{o.onCompleted(r?.updateProject)}}),u={title:l?.title,url:l?.url,description:l?.description},E=r=>{const c=l?.id,h=I.pick(r,["title","description"]);d({variables:{projectId:c,object:h}})},f=r=>{console.log("Failed:",r)},n=(r,c)=>c?Promise.resolve():Promise.reject(`${r.field} is required`),y={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return e.createElement(t,{...y,name:"project-form",form:p,onFinish:E,onFinishFailed:f,initialValues:u},e.createElement(t.Item,{label:"Project Title"},e.createElement(t.Item,{name:"title",noStyle:!0,rules:[{validator:n}]},e.createElement(a,{placeholder:"Title"}))),e.createElement(t.Item,{label:"Data Endpoint URL"},e.createElement(t.Item,{name:"url",noStyle:!0,rules:[{type:"url",message:"please enter a url!"},{validator:n}]},e.createElement(a,{placeholder:"https://example.com",type:"url"}))),e.createElement(t.Item,{label:"Description"},e.createElement(t.Item,{name:"description",noStyle:!0,rules:[{validator:n}]},e.createElement(a,{placeholder:"Type description here"}))),e.createElement(t.Item,{className:"margin-0 project__form__buttons"},e.createElement(a.Group,{className:"grid__two"},e.createElement(t.Item,{className:"margin-0"},e.createElement(m,{block:!0,type:"default",onClick:o.onCancel},"Cancel")),e.createElement(t.Item,{className:"margin-0"},e.createElement(m,{block:!0,type:"primary",loading:s,disabled:s,htmlType:"submit"},"Update")))))};export default v;
