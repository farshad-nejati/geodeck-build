import a,{useState as p}from"https://cdn.skypack.dev/react";import{message as h,Typography as w}from"https://cdn.skypack.dev/antd";import{BASE_URL as E}from"../../constant.js";import{useMutation as j,useReactiveVar as k}from"https://cdn.skypack.dev/@apollo/client";import{activeProjectVar as b}from"../../apollo/cache.js";import{CREATE_PLOT as N}from"../../apollo/mutations/index.js";import{GET_PLOTS as H}from"../../apollo/queries/index.js";import*as C from"../../helpers/plot.js";const{Text:I}=w,m=[{name:"bar",type:"bar",img:"1H.png",active:!1},{name:"pie",type:"pie",img:"2H.png",active:!1},{name:"radar",type:"radar",img:"3H.png",active:!1},{name:"area",type:"area",img:"4H.png",active:!1},{name:"line",type:"line",img:"5H.png",active:!0},{name:"scatter",type:"scatter",img:"6H.png",active:!0}],$="new-plot",G=2,x=d=>{const[s,n]=p(!1),[g,f]=p(null),l=k(b).id,{plotsLength:u,onCreateTemp:v,onOverWriteTemp:_}=d,[y,{data:D,loading:L,refetch:R}]=j(N,{refetchQueries:[{query:H,variables:{projectId:l}}],onCompleted:e=>{n(!1);const o=e?.createPlot,t=C.createSingle(o);_(t,g)},onError:e=>{console.log(e),h.error({content:"Plot creation Failed!",key:$,duration:2}),n(!1)}}),P=e=>{if(m.find(t=>t.type===e).active&&!s){n(!0);const t=`Plot ${e} ${u+1}`,r=new Date().getTime(),c=new Date,T=new Date,i={id:r,name:t,type:e,createdAt:c,updatedAt:T,temp:!0};v(i),y({variables:{projectId:l,name:t,type:e}}),f(i.id)}};return a.createElement("div",{className:"plot__new"},a.createElement(I,{className:"plot__new__header capitalize"},"add New Plot"),a.createElement("div",{className:"grid__three plot__new__icons"},m.map(({name:e,type:o,img:t,active:r},c)=>a.createElement("figure",{className:`plot__new__figure ${s||!r?"disable":""}`,key:c,onClick:()=>P(o)},a.createElement("img",{src:`${E}/plotIcon/${t}`,alt:e,className:"image"})))))};export default x;
