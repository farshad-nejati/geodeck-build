import a,{useState as p}from"../../../_snowpack/pkg/react.js";import{message as j,Typography as y}from"../../../_snowpack/pkg/antd.js";import{BASE_URL as E}from"../../constant.js";import{useMutation as k,useReactiveVar as h}from"../../../_snowpack/pkg/@apollo/client.js";import{activeProjectVar as b}from"../../apollo/cache.js";import{CREATE_PLOT as N}from"../../apollo/mutations/index.js";import{GET_PLOTS as H}from"../../apollo/queries/index.js";import*as C from"../../helpers/plot.js";const{Text:I}=y,m=[{name:"bar",type:"bar",img:"1H.png",active:!1},{name:"pie",type:"pie",img:"2H.png",active:!1},{name:"radar",type:"radar",img:"3H.png",active:!1},{name:"area",type:"area",img:"4H.png",active:!1},{name:"line",type:"line",img:"5H.png",active:!0},{name:"scatter",type:"scatter",img:"6H.png",active:!0}],$="new-plot",G=2,x=d=>{const[c,n]=p(!1),[g,f]=p(null),l=h(b).id,{plotsLength:_,onCreateTemp:u,onOverWriteTemp:v}=d,[P,{data:D,loading:L,refetch:R}]=k(N,{refetchQueries:[{query:H,variables:{projectId:l}}],onCompleted:e=>{n(!1);const o=e?.createPlot,t=C.createSingle(o);v(t,g)},onError:e=>{console.log(e),j.error({content:"Plot creation Failed!",key:$,duration:2}),n(!1)}}),w=e=>{if(m.find(t=>t.type===e).active&&!c){n(!0);const t=`Plot ${e} ${_+1}`,r=new Date().getTime(),s=new Date,T=new Date,i={id:r,name:t,type:e,createdAt:s,updatedAt:T,temp:!0};u(i),P({variables:{projectId:l,name:t,type:e}}),f(i.id)}};return a.createElement("div",{className:"plot__new"},a.createElement(I,{className:"plot__new__header capitalize"},"add New Plot"),a.createElement("div",{className:"grid__three plot__new__icons"},m.map(({name:e,type:o,img:t,active:r},s)=>a.createElement("figure",{className:`plot__new__figure ${c||!r?"disable":""}`,key:s,onClick:()=>w(o)},a.createElement("img",{src:`${E}/plotIcon/${t}`,alt:e,className:"image"})))))};export default x;
