import t,{useEffect as g,useState as l}from"../../../_snowpack/pkg/react.js";import C from"../../../_snowpack/pkg/localforage.js";import T from"../../../_snowpack/pkg/lodash.js";import{InputNumber as b,message as u,Slider as j,Typography as I}from"../../../_snowpack/pkg/antd.js";import{CameraFilled as V,StepBackwardFilled as O,FastBackwardFilled as B,CaretRightFilled as R,FastForwardFilled as $,StepForwardFilled as P}from"../../../_snowpack/pkg/@ant-design/icons.js";import{activeOverlayVar as r,newOverlayVar as A}from"../../apollo/cache.js";import{useReactiveVar as f}from"../../../_snowpack/pkg/@apollo/client.js";const{Text:D}=I,M=()=>{const[n,_]=l([]),s=f(r),k=f(A),[o,v]=l({min:0,max:20}),[c,i]=l(!1),m="scshot";g(()=>{C.getItem("years").then(e=>{const a=e?.map(S=>T.toInteger(S)),N=a.length-1;_(a),v({min:a[0],max:a[N]}),s||r(a[0])})},[k]),g(()=>{if(c){const e=setTimeout(()=>i(!1),5e3);return()=>{clearTimeout(e)}}},[c]);const y=new CustomEvent("onscreenshot",{detail:{},bubbles:!0,cancelable:!0,composed:!1}),w=()=>{if(c){u.warning({content:"Must wait 5s after each save!",sckey:m});return}u.loading({content:"Saving...",sckey:m}),document.dispatchEvent(y),i(!0)},h=()=>{const e=n.findIndex(a=>a===s);0<e&&r(n[e-1])},E=()=>{const e=n.findIndex(a=>a===s);e<n.length-1&&r(n[e+1])},p=e=>{r(e)},d=typeof s=="number"?s:0,x=()=>t.createElement("div",{className:"studio__player__time-setting"},t.createElement(D,null,"Timestep"),t.createElement(b,{value:d,min:o.min,max:o.max,formatter:e=>`${e} / ${o.max}`,parser:e=>e.replace(/\$\s?|(,*)/g,""),onChange:p}),t.createElement(V,{className:"icon-large",onClick:w})),F=()=>t.createElement("div",{className:"studio__player__actions"},t.createElement(O,{className:"geo-icon",onClick:h}),t.createElement(B,{className:"geo-icon"}),t.createElement(R,{className:"geo-icon"}),t.createElement($,{className:"geo-icon"}),t.createElement(P,{className:"geo-icon",onClick:E}));return t.createElement("div",{className:"studio__player"},F(),x(),t.createElement(j,{min:o.min,max:o.max,onChange:p,value:d,className:"studio__player__slider"}))};export default M;
