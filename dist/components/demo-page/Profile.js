import t,{useEffect as d,useState as i}from"../../../_snowpack/pkg/react.js";import{useAuth0 as y}from"../../../_snowpack/pkg/@auth0/auth0-react.js";import{Button as A}from"../../../_snowpack/pkg/antd.js";import"../../../_snowpack/pkg/axios.js";const E=()=>{const{user:a,isAuthenticated:g,getAccessTokenSilently:p}=y(),[s,h]=i(null),[c,f]=i(""),[m,u]=i(!1),r="tubein.us.auth0.com";d(()=>{(async()=>{try{const e=await p({audience:`https://${r}/api/v2/`});localStorage.setItem("token",e),f(e),u(!0)}catch(e){console.log(e.message)}})()},[]),d(()=>{(async()=>{try{console.log(`myAccessToken : ${c}`),console.log(`metadataResponse : ${s}`);const e=`https://${r}/api/v2/users/${a.sub}`,n=await fetch(e,{headers:{Authorization:`Bearer ${c}`}});console.log(`metadataResponse : ${n}`);const o=await n.json();h(o)}catch(e){console.log(e.message)}})(),u(m)},[m]);const k=()=>{const l=`https://${r}/api/v2/jobs/verification-email`,e=s.identities;console.log(s),console.log(e);const n={user_id:s.user_id,client_id:"tmJ9z9ogkVWMRPEALjml2wGfaODsxveo",identity:{provider:e[0].provider,user_id:e[0].user_id}};fetch(l,{method:"POST",headers:{Authorization:`Bearer ${c}`},body:JSON.stringify(n)}).then(o=>{console.log(`response: ${o}`)}).catch(o=>{console.log(`error: ${o}`)})};return t.createElement(t.Fragment,null,g&&t.createElement("div",null,t.createElement("img",{src:a?.picture,alt:a?.name}),t.createElement("h2",null,a?.name),t.createElement("p",null,a?.email),t.createElement("h3",null,"User? Metadata"),s?t.createElement("pre",{style:{maxWidth:"45vw"}},JSON.stringify(s,null,2)):"No user metadata defined"),t.createElement(A,{onClick:k}," Send Verification Email"))};export default E;
