import t,{useEffect as u,useState as i}from"https://cdn.skypack.dev/react";import{useAuth0 as y}from"https://cdn.skypack.dev/@auth0/auth0-react";import{Button as v}from"https://cdn.skypack.dev/antd";import"https://cdn.skypack.dev/axios";const A=()=>{const{user:a,isAuthenticated:p,getAccessTokenSilently:h}=y(),[s,g]=i(null),[c,f]=i(""),[d,m]=i(!1),r="tubein.us.auth0.com";u(()=>{(async()=>{try{const e=await h({audience:`https://${r}/api/v2/`});localStorage.setItem("token",e),f(e),m(!0)}catch(e){console.log(e.message)}})()},[]),u(()=>{(async()=>{try{console.log(`myAccessToken : ${c}`),console.log(`metadataResponse : ${s}`);const e=`https://${r}/api/v2/users/${a.sub}`,n=await fetch(e,{headers:{Authorization:`Bearer ${c}`}});console.log(`metadataResponse : ${n}`);const o=await n.json();g(o)}catch(e){console.log(e.message)}})(),m(d)},[d]);const k=()=>{const l=`https://${r}/api/v2/jobs/verification-email`,e=s.identities;console.log(s),console.log(e);const n={user_id:s.user_id,client_id:"tmJ9z9ogkVWMRPEALjml2wGfaODsxveo",identity:{provider:e[0].provider,user_id:e[0].user_id}};fetch(l,{method:"POST",headers:{Authorization:`Bearer ${c}`},body:JSON.stringify(n)}).then(o=>{console.log(`response: ${o}`)}).catch(o=>{console.log(`error: ${o}`)})};return t.createElement(t.Fragment,null,p&&t.createElement("div",null,t.createElement("img",{src:a?.picture,alt:a?.name}),t.createElement("h2",null,a?.name),t.createElement("p",null,a?.email),t.createElement("h3",null,"User? Metadata"),s?t.createElement("pre",{style:{maxWidth:"45vw"}},JSON.stringify(s,null,2)):"No user metadata defined"),t.createElement(v,{onClick:k}," Send Verification Email"))};export default A;
