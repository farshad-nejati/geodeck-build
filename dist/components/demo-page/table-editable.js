var y=Object.defineProperty;var l=(r,e,t)=>(typeof e!="symbol"&&(e+=""),e in r?y(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t);import n,{useContext as k,useState as b,useEffect as v,useRef as w}from"https://cdn.skypack.dev/react";import{Table as x,Input as C,Button as I,Popconfirm as L,Form as c}from"https://cdn.skypack.dev/antd";const p=n.createContext(null),P=({index:r,...e})=>{const[t]=c.useForm();return n.createElement(c,{form:t,component:!1},n.createElement(p.Provider,{value:t},n.createElement("tr",{...e})))},D=({title:r,editable:e,children:t,dataIndex:a,record:s,handleSave:d,...g})=>{const[o,S]=b(!1),u=w(null),m=k(p);v(()=>{o&&u.current.focus()},[o]);const h=()=>{S(!o),m.setFieldsValue({[a]:s[a]})},E=async()=>{try{const i=await m.validateFields();h(),d({...s,...i})}catch(i){console.log("Save failed:",i)}};let f=t;return e&&(f=o?n.createElement(c.Item,{style:{margin:0},name:a,rules:[{required:!0,message:`${r} is required.`}]},n.createElement(C,{ref:u,onPressEnter:E,onBlur:E})):n.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:h},t)),n.createElement("td",{...g},f)};class R extends n.Component{constructor(e){super(e);l(this,"handleDelete",e=>{const t=[...this.state.dataSource];this.setState({dataSource:t.filter(a=>a.key!==e)})});l(this,"handleAdd",()=>{const{count:e,dataSource:t}=this.state,a={key:e,name:`Edward King ${e}`,age:"32",address:`London, Park Lane no. ${e}`};this.setState({dataSource:[...t,a],count:e+1})});l(this,"handleSave",e=>{const t=[...this.state.dataSource],a=t.findIndex(d=>e.key===d.key),s=t[a];t.splice(a,1,{...s,...e}),this.setState({dataSource:t})});this.columns=[{title:"name",dataIndex:"name",width:"30%",editable:!0},{title:"age",dataIndex:"age"},{title:"address",dataIndex:"address"},{title:"operation",dataIndex:"operation",render:(t,a)=>this.state.dataSource.length>=1?n.createElement(L,{title:"Sure to delete?",onConfirm:()=>this.handleDelete(a.key)},n.createElement("a",null,"Delete")):null}],this.state={dataSource:[{key:"0",name:"Edward King 0",age:"32",address:"London, Park Lane no. 0"},{key:"1",name:"Edward King 1",age:"32",address:"London, Park Lane no. 1"}],count:2}}render(){const{dataSource:e}=this.state,t={body:{row:P,cell:D}},a=this.columns.map(s=>s.editable?{...s,onCell:d=>({record:d,editable:s.editable,dataIndex:s.dataIndex,title:s.title,handleSave:this.handleSave})}:s);return n.createElement("div",null,n.createElement(I,{onClick:this.handleAdd,type:"primary",style:{marginBottom:16}},"Add a row"),n.createElement(x,{components:t,rowClassName:()=>"editable-row",bordered:!0,dataSource:e,columns:a}))}}export default R;
