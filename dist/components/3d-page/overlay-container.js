import e,{useState as r,useEffect as l,Suspense as k}from"../../../_snowpack/pkg/react.js";import{useReactiveVar as p}from"../../../_snowpack/pkg/@apollo/client.js";import{OrbitControls as d,Stage as j,OrthographicCamera as E}from"../../../_snowpack/pkg/@react-three/drei.js";import{Canvas as w}from"../../../_snowpack/pkg/@react-three/fiber.js";import f from"./loader.js";import O from"./overlay-component.js";import a from"../../../_snowpack/pkg/localforage.js";import{activeOverlayVar as C,newOverlayVar as I}from"../../apollo/cache.js";const S=()=>{const[g,c]=r(!1),[u,m]=r([]),[y,v]=r({x:0,y:0,z:0}),[n,h]=r([]),i=p(I),o=p(C);return l(()=>{a.getItem("years").then(t=>h(t)),a.getItem("meta").then(t=>{v(t)})},[,i]),l(()=>{if(n?.length){const t=n[0];a.getItem(t).then(s=>m(s))}},[n,i]),l(()=>{if(o){c(!0);const t=o?.toString();a.getItem(t).then(s=>{m(s),c(!1)})}},[o]),e.createElement(w,null,g?e.createElement(f,null):e.createElement(k,{fallback:e.createElement(f,null)},e.createElement(j,{preset:"rembrandt",intensity:1,shadows:!1,environment:"city",adjustCamera:!0},e.createElement(O,{items:u,meta:y}),e.createElement(E,null)),e.createElement(d,null)))};export default S;
