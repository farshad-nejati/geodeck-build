import e from"../../_snowpack/pkg/react.js";import i from"../../_snowpack/pkg/lodash.js";import{useReactiveVar as A}from"../../_snowpack/pkg/@apollo/client.js";import{Button as r,message as d}from"../../_snowpack/pkg/antd.js";import{plotsVar as h}from"../apollo/cache.js";import E from"../components/hooks/use-undo.js";import*as o from"../helpers/plot.js";import*as w from"../apollo/initial-states.js";import _ from"../components/auto-save.js";import{findPrevFromUndo as b}from"../helpers/store-handler.js";const T=()=>{const{plots:m,active:x}=A(h),[a,{set:u,reset:C,undo:f,redo:g,canUndo:y,canRedo:k}]=E(m),{present:s,past:U,future:O}=a,l=o.getAsArray(s),P=t=>{const n=b(t),{present:c}=t,v=i.difference(o.getAsArray(c),o.getAsArray(n));if(console.log("diff:"),console.log(v),i.isEmpty(c))return null;const p="save-plot";d.loading({content:"saving...",key:p}),setTimeout(()=>{d.success({content:"saved successfull!",key:p,duration:2})},3e3)},j=()=>{const t={...w.PLOT_STATE,id:l.length+1},n=o.updateList(s,t);u(n)};return console.log("prsent state:"),console.log(s),e.createElement("div",{style:{padding:"1rem",marginTop:"10rem"}},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",maxWidth:"30vw",margin:"auto",marginBottom:"2rem"}},e.createElement(r,{type:"primary",key:"Add Object",onClick:j},"Add Object"),e.createElement(r,{type:"primary",key:"undo",onClick:f,disabled:!y},"undo"),e.createElement(r,{type:"primary",key:"redo",onClick:g,disabled:!k},"redo"),e.createElement(_,{onSave:P,data:a})),e.createElement("p",{style:{textAlign:"center"}},"You add ",l.length," Plots"))};export default T;
