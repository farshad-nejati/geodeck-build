import e from"https://cdn.skypack.dev/react";import p from"https://cdn.skypack.dev/lodash";import{useReactiveVar as A}from"https://cdn.skypack.dev/@apollo/client";import{Button as r,message as i}from"https://cdn.skypack.dev/antd";import{plotsVar as j}from"../apollo/cache.js";import E from"../components/hooks/use-undo.js";import*as o from"../helpers/plot.js";import*as b from"../apollo/initial-states.js";import T from"../components/auto-save.js";import{findPrevFromUndo as w}from"../helpers/store-handler.js";const x=()=>{const{plots:m,active:C}=A(j),[a,{set:u,reset:U,undo:y,redo:f,canUndo:g,canRedo:v}]=E(m),{present:s,past:O,future:R}=a,l=o.getAsArray(s),k=t=>{const n=w(t),{present:c}=t,h=p.difference(o.getAsArray(c),o.getAsArray(n));if(console.log("diff:"),console.log(h),p.isEmpty(c))return null;const d="save-plot";i.loading({content:"saving...",key:d}),setTimeout(()=>{i.success({content:"saved successfull!",key:d,duration:2})},3e3)},P=()=>{const t={...b.PLOT_STATE,id:l.length+1},n=o.updateList(s,t);u(n)};return console.log("prsent state:"),console.log(s),e.createElement("div",{style:{padding:"1rem",marginTop:"10rem"}},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",maxWidth:"30vw",margin:"auto",marginBottom:"2rem"}},e.createElement(r,{type:"primary",key:"Add Object",onClick:P},"Add Object"),e.createElement(r,{type:"primary",key:"undo",onClick:y,disabled:!g},"undo"),e.createElement(r,{type:"primary",key:"redo",onClick:f,disabled:!v},"redo"),e.createElement(T,{onSave:k,data:a})),e.createElement("p",{style:{textAlign:"center"}},"You add ",l.length," Plots"))};export default x;
