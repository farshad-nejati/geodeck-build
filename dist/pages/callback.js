var p=Object.defineProperty;var a=(o,t,e)=>(typeof t!="symbol"&&(t+=""),t in o?p(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e);import n,{Component as l}from"https://cdn.skypack.dev/react";import{withRouter as m}from"https://cdn.skypack.dev/react-router-dom";import{withAuth0 as h}from"https://cdn.skypack.dev/@auth0/auth0-react";import{AUTH0_AUDIENCE as u}from"../constant.js";import{accessToken as d}from"../apollo/cache.js";import"https://cdn.skypack.dev/graphql";class k extends l{constructor(){super(...arguments);a(this,"saveUserInfo",t=>{const{sub:e,email_verified:s,name:c,nickname:r,picture:i}=t;localStorage.setItem("sub",e),localStorage.setItem("email_verified",s),localStorage.setItem("name",r||parseName(c)),localStorage.setItem("image",i)});a(this,"parseName",t=>t.split("@"))}async componentDidUpdate(t){if(console.log(t),console.log(this.props),t.auth0.isAuthenticated!==this.props.auth0.isAuthenticated){console.log(this.props.auth0);const{user:e}=this.props.auth0;e&&this.saveUserInfo(e);const s=await this.props.auth0.getAccessTokenSilently({audience:u});localStorage.setItem("token",s),d(s),this.props.history.replace("/project")}}render(){return console.log(this.props),n.createElement("div",null,"loading...")}}export default h(m(k));
