import{_ as V}from"./common/extends-07c24333.js";import{p as W,s as X,h as Y,i as Z,j as ee,k as te,l as ne,n as re,H as ie,r as ae,o as S}from"./common/index-82d9a062.js";import"./common/_commonjsHelpers-b3efd043.js";import"./common/ApolloLink-f29e3da6.js";import"./common/inspect-9dd07694.js";import"./common/parser-1649b75f.js";var f=Object.freeze({__proto__:null,parseAndCheckHttpResponse:W,serializeFetchParameter:X,fallbackHttpConfig:Y,selectHttpOptionsAndBody:Z,checkFetcher:ee,createSignalIfSupported:te,selectURI:ne,createHttpLink:re,HttpLink:ie,rewriteURIForGET:ae}),oe=function(e){var t=e.uri,n=e.name,i=e.type;this.uri=t,this.name=n,this.type=i},j=function(e){return typeof File!="undefined"&&e instanceof File||typeof Blob!="undefined"&&e instanceof Blob||e instanceof oe},se=function d(e,t,n){t===void 0&&(t=""),n===void 0&&(n=j);var i,m=new Map;function p(s,c){var l=m.get(c);l?l.push.apply(l,s):m.set(c,s)}if(n(e))i=null,p([t],e);else{var h=t?t+".":"";if(typeof FileList!="undefined"&&e instanceof FileList)i=Array.prototype.map.call(e,function(s,c){return p([""+h+c],s),null});else if(Array.isArray(e))i=e.map(function(s,c){var l=d(s,""+h+c,n);return l.files.forEach(p),l.clone});else if(e&&e.constructor===Object){i={};for(var v in e){var F=d(e[v],""+h+v,n);F.files.forEach(p),i[v]=F.clone}}else i=e}return{clone:i,files:m}},ce=function(e,t,n){e.append(t,n,n.name)},le=j,pe=S.ApolloLink,D=S.Observable,fe=f.createSignalIfSupported,de=f.fallbackHttpConfig,ue=f.parseAndCheckHttpResponse,me=f.rewriteURIForGET,he=f.selectHttpOptionsAndBody,ve=f.selectURI,G=f.serializeFetchParameter,Fe=function(e){var t=e===void 0?{}:e,n=t.uri,i=n===void 0?"/graphql":n,m=t.useGETForQueries,p=t.isExtractableFile,h=p===void 0?le:p,v=t.FormData,F=t.formDataAppendFile,s=F===void 0?ce:F,c=t.fetch,l=t.fetchOptions,P=t.credentials,T=t.headers,z=t.includeExtensions,B={http:{includeExtensions:z},options:l,credentials:P,headers:T};return new pe(function(u){var y=u.getContext(),g=y.clientAwareness;g=g===void 0?{}:g;var I=g.name,O=g.version,q=y.headers,N={http:y.http,options:y.fetchOptions,credentials:y.credentials,headers:V({},I&&{"apollographql-client-name":I},O&&{"apollographql-client-version":O},q)},R=he(u,de,B,N),o=R.options,C=R.body,L=se(C,"",h),U=L.clone,H=L.files,x=ve(u,i);if(H.size){delete o.headers["content-type"];var Q=v||FormData,A=new Q;A.append("operations",G(U,"Payload"));var _={},E=0;H.forEach(function(r){_[++E]=r}),A.append("map",JSON.stringify(_)),E=0,H.forEach(function(r,b){s(A,++E,b)}),o.body=A}else if(m&&!u.query.definitions.some(function(r){return r.kind==="OperationDefinition"&&r.operation==="mutation"})&&(o.method="GET"),o.method==="GET"){var $=me(x,C),J=$.newURI,w=$.parseError;if(w)return new D(function(r){r.error(w)});x=J}else o.body=G(U,"Payload");var M=fe(),k=M.controller;k&&(o.signal&&o.signal.addEventListener("abort",function(){k.abort()}),o.signal=k.signal);var K=c||fetch;return new D(function(r){var b;return K(x,o).then(function(a){return u.setContext({response:a}),a}).then(ue(u)).then(function(a){r.next(a),r.complete()}).catch(function(a){b||(a.result&&a.result.errors&&a.result.data&&r.next(a.result),r.error(a))}),function(){b=!0,k&&k.abort()}})})};export{Fe as createUploadLink};
